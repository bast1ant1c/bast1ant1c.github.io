<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>SafeWebHeaders.py - Bast1ant1c</title>
<meta name="description" content="Vamos a conocer la utilidad SafeWebHeaders.py creada por The Game 008 para auditar cabeceras web. ¡Let’s hack!">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Bast1ant1c">
<meta property="og:title" content="SafeWebHeaders.py">
<meta property="og:url" content="http://localhost:4000/safewebheaders/">


  <meta property="og:description" content="Vamos a conocer la utilidad SafeWebHeaders.py creada por The Game 008 para auditar cabeceras web. ¡Let’s hack!">



  <meta property="og:image" content="http://localhost:4000/assets/images/safewebheaders/01-inicio.png">





  <meta property="article:published_time" content="2023-03-10T00:00:00-05:00">





  

  


<link rel="canonical" href="http://localhost:4000/safewebheaders/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Bast1ant1c",
      "url": "http://localhost:4000/",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Bast1ant1c Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/" >Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/halloffame/" >Hall of Fame</a>
            </li><li class="masthead__menu-item">
              <a href="/buscador/" >Search</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000//" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">SafeWebHeaders.py</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="BAST1ANT1C" itemprop="image" style="padding:25px;border:5px solid #434040;max-width:130px;border-radius:10%;">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">BAST1ANT1C</h3>
    
    
      <p class="author__bio" itemprop="description">
        Ethical hacker | eJPT
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/bast1ant1c" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      
        <li>
          <a href="https://github.com/bast1ant1c" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      
      
      
        <li>
          <a href="https://instagram.com/bast1ant1c" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram
          </a>
        </li>
      

      
        <li>
          <a href="https://tiktok.com/@bast1ant1c" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-tiktok" aria-hidden="true"></i> TikTok
          </a>
        </li>
      
      
      

      

      

      



      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="SafeWebHeaders.py">
    <meta itemprop="description" content="Vamos a conocer la utilidad SafeWebHeaders.py creada por The Game 008 para auditar cabeceras web. ¡Let’s hack!">
    <meta itemprop="datePublished" content="March 10, 2023">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">SafeWebHeaders.py
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2023-03-10T00:00:00-05:00">March 10, 2023 </time>&emsp;
          
          
        </p>
        <p align="center">
<img src="/assets/images/safewebheaders/02-tarjeta.png" />
</p>

<p>¡Hola! En esta ocasión vamos a conocer la utilidad <a href="https://raw.githubusercontent.com/Thegame008/Secure-Headers-OWASP/main/SafeWebHeaders.py">SafeWebHeaders.py</a> creada por <a href="https://github.com/Thegame008/">The Game 008</a>, para auditar las cabeceras de una pagina web basada en las recomendaciones de <code class="language-plaintext highlighter-rouge">OWASP</code> (Open Web Application Security Project).</p>

<h2 id="cabeceras-web">CABECERAS WEB</h2>

<p>Las cabeceras web, son parte de los datos que se envían desde un servidor web al cliente en una respuesta <code class="language-plaintext highlighter-rouge">HTTP</code>. Estas cabeceras <strong>pueden</strong> contienen información adicional sobre la respuesta, incluyendo información sobre el servidor, la caché, el tipo de contenido, la codificación de caracteres, entre otros. Estas son indispensables porque permiten que los navegadores web y otros clientes logren procesar la respuesta del servidor y representar la información al usuario final.</p>

<p>Algunos de los riesgos que se pueden presentar a nivel de seguridad en cabeceras son las siguientes:</p>

<ul>
  <li>Divulgación de información</li>
  <li>Inyecciones de código</li>
  <li>Secuestros de sesiones o clicks (hijacking)</li>
  <li>Exposición de información confidencial</li>
</ul>

<p align="center">
<img src="/assets/images/safewebheaders/03-header.png" />
</p>

<h2 id="owasp">OWASP</h2>

<p><strong>Open Web Application Security Project</strong> es una organización sin ánimo de lucro con el objetivo de mejorar la seguridad del software y las aplicaciones web. Gracias a esto se han podido identificar los riesgos de seguridad más críticos y comunes a nivel <code class="language-plaintext highlighter-rouge">web</code> y han proporcionado recursos y recomendaciones para ayudar a las comunidades a proteger sus aplicativos y páginas web.</p>

<p align="center">
<img src="/assets/images/safewebheaders/04-header.png" />
</p>

<p>OWASP tiene una lista de los <a href="https://owasp.org/www-project-top-ten/">diez riesgos de seguridad más críticos en aplicaciones web</a>, conocida como <code class="language-plaintext highlighter-rouge">OWASP Top Ten</code>. Entre este top se encuentra la falta de protección adecuada en las cabeceras web.</p>

<p>A continuación, las <strong>recomendaciones</strong> proporcionadas por OWASP para mejorar la seguridad de las aplicaciones web:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Strict-Transport-Security (HSTS)</code> que obliga al navegador a utilizar solo HTTPS para las solicitudes futuras a la misma dirección web</li>
  <li><code class="language-plaintext highlighter-rouge">X-Frame-Options</code> que evita la incrustación no deseada de páginas web en un marco (frame) y ayuda a prevenir el clickjacking</li>
  <li><code class="language-plaintext highlighter-rouge">X-XSS-Protection</code> que activa una protección integrada contra ataques XSS (Cross-Site Scripting) en los navegadores modernos</li>
  <li><code class="language-plaintext highlighter-rouge">X-Content-Type-Options</code> que evita la interpretación automática del contenido cargado para prevenir ataques MIME sniffing</li>
  <li><code class="language-plaintext highlighter-rouge">Content-Security-Policy</code> que limita los recursos que un sitio web puede cargar en su página, lo que ayuda a prevenir los ataques de inyección de código</li>
</ul>

<h2 id="instalar-safewebheaderspy">INSTALAR SafeWebHeaders.py</h2>

<p>En el <a href="https://github.com/Thegame008/Secure-Headers-OWASP">repositorio</a> puedes encontrar el paso a paso de como instalar la herramienta, sin embargo, acá tambien te mostramos el proceso.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/Thegame008/Secure-Headers-OWASP.git
<span class="nb">cd </span>Secure-Headers-OWASP
python3 SafeWebHeaders.py
</code></pre></div></div>

<p align="center">
<img src="/assets/images/safewebheaders/06-virtual.png" />
</p>

<h2 id="safewebheaderspy-en-acción">SafeWebHeaders.py EN ACCIÓN</h2>

<p>Luego de instalar la herramienta, vamos a hacer una prueba para ver que tan seguro es nuestro blog a nivel <code class="language-plaintext highlighter-rouge">web</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 SafeWebHeaders.py
Introduce la URL a escanear: https://bast1ant1c.github.io
</code></pre></div></div>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cabeceras correctamente implementadas:

Cabeceras con configuración incorrecta:
- Strict-Transport-Security:
	- Valor recomendado por OWASP: max-age<span class="o">=</span>63072000<span class="p">;</span> includeSubDomains<span class="p">;</span> preload
	- Configuración actual en la URL: max-age<span class="o">=</span>31556952
	- Riesgo: Vulnerabilidad a ataques de MITM

Cabeceras que deberían estar implementadas, pero no se ven implementadas:
- X-Frame-Options: SAMEORIGIN
- X-XSS-Protection: 1<span class="p">;</span> <span class="nv">mode</span><span class="o">=</span>block
- X-Content-Type-Options: nosniff
- Content-Security-Policy: default-src <span class="s1">'self'</span><span class="p">;</span> base-uri <span class="s1">'self'</span><span class="p">;</span> img-src <span class="s1">'self'</span> data:<span class="p">;</span> object-src <span class="s1">'none'</span><span class="p">;</span> script-src <span class="s1">'self'</span><span class="p">;</span> style-src <span class="s1">'self'</span> <span class="s1">'unsafe-inline'</span>

Divulgación de información en cabecera:
- Server: GitHub.com
</code></pre></div></div>

<p>Como podemos evidenciar, esta utilidad nos permite identificar cabeceras correctamente implementadas, con configuración incorrecta, no implementadas y divulgación de información sensible, en esta oportunidad podemos ver que nuestro blog necesita un ajuste a nivel de cabeceras para que sea un sitio seguro.</p>

<p align="center">
<img src="/assets/images/safewebheaders/05-virtual.png" />
</p>

<h2 id="configuración-máquina-1">CONFIGURACIÓN MÁQUINA 1</h2>

<p>Nuestra primera máquina tendrá conexión directa con la interfaz física, por lo tanto, solo requerimos de un adaptador de red en adaptador puente.</p>
<blockquote>

  <ul>
    <li>Clic en la <code class="language-plaintext highlighter-rouge">máquina</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Configuración</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Red</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Adaptador 1</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Enable Network Adapter</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Adaptador puente</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Interfaz</code> física</li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Aceptar</code></li>
  </ul>

</blockquote>

<p align="center">
<img src="/assets/images/safewebheaders/08-virtual.png" />
</p>

<h2 id="configuración-máquina-2">CONFIGURACIÓN MÁQUINA 2</h2>

<p>Nuestra segunda máquina tendrá la misma conexión con adaptador puente y otro adaptador de red para la nueva interfaz configurada anteriormente.</p>

<h3 id="configuración-interfaz-puente">CONFIGURACIÓN INTERFAZ PUENTE</h3>
<blockquote>

  <ul>
    <li>Clic en la <code class="language-plaintext highlighter-rouge">máquina</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Configuración</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Red</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Adaptador 1</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Enable Network Adapter</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Adaptador puente</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Interfaz</code> física</li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Aceptar</code></li>
  </ul>

</blockquote>

<p align="center">
<img src="/assets/images/safewebheaders/09-virtual.png" />
</p>

<h3 id="configuración-interfaz-creada">CONFIGURACIÓN INTERFAZ CREADA</h3>
<blockquote>

  <ul>
    <li>Clic en la <code class="language-plaintext highlighter-rouge">máquina</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Configuración</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Red</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Adaptador 2</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Enable Network Adapter</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Adaptador sólo-anfitrión</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Interfaz creada</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Aceptar</code></li>
  </ul>

</blockquote>

<p align="center">
<img src="/assets/images/safewebheaders/10-virtual.png" />
</p>

<h2 id="configuración-máquina-3">CONFIGURACIÓN MÁQUINA 3</h2>

<p>Nuestra tercera máquina tendrá conexión directa con la interfaz creada, por lo tanto, solo requerimos de un adaptador de red en adaptador sólo-anfitrión.</p>
<blockquote>

  <ul>
    <li>Clic en la <code class="language-plaintext highlighter-rouge">máquina</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Configuración</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Red</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Adaptador 2</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Enable Network Adapter</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Adaptador sólo-anfitrión</code></li>
    <li>Escoger <code class="language-plaintext highlighter-rouge">Interfaz creada</code></li>
    <li>Clic en <code class="language-plaintext highlighter-rouge">Aceptar</code></li>
  </ul>

</blockquote>

<p align="center">
<img src="/assets/images/safewebheaders/11-virtual.png" />
</p>

<h2 id="validación-de-conexiones">VALIDACIÓN DE CONEXIONES</h2>

<p>Ya tenemos el entorno configurado, ahora vamos a validar si nuestras máquinas tienen la configuración de red correcta.</p>

<p align="center">
<img src="/assets/images/safewebheaders/12-virtual.png" />
</p>

<p>Como podemos ver, la primera máquina tiene una dirección asociada a la primera red únicamente, la segunda máquina tiene esta misma red y adicionalmente la red nueva creada a través de la interfaz, por último, la tercera máquina se encuentra asociada a la segunda red interna, también generada por la nueva interfaz.</p>

<h2 id="prueba-de-conectividad">PRUEBA DE CONECTIVIDAD</h2>

<p>Nuestra configuración ha sido exitosa, tenemos que hacer pruebas de conectividad para corroborar que nuestras redes sean operativas, debemos tener en cuenta lo siguiente:</p>
<blockquote>

  <ul>
    <li>La <code class="language-plaintext highlighter-rouge">máquina 1</code> solo puede tener conectividad por el mismo segmento de la <code class="language-plaintext highlighter-rouge">máquina 2</code></li>
    <li>La <code class="language-plaintext highlighter-rouge">máquina 2</code> tiene conectividad por el mismo segmento de las <code class="language-plaintext highlighter-rouge">máquinas 1 y 2</code></li>
    <li>La <code class="language-plaintext highlighter-rouge">máquina 3</code> solo puede tener conectividad por el mismo segmento de la <code class="language-plaintext highlighter-rouge">máquina 2</code></li>
  </ul>

</blockquote>

<p align="center">
<img src="/assets/images/safewebheaders/13-virtual.png" />
</p>

<p>Con esta configuración vamos a tener la posibilidad de crear nuevos entornos para practicar nuestros ejercicios de hacking orientados al pivoting, tema bastante importante para certificaciones como la <code class="language-plaintext highlighter-rouge">eCPPT</code>, crear laboratorios propios nos da una ventaja en no depender de otras infraestructuras para practicar, así que esperen una corta serie pero de mucho aprendizaje en los próximos posts.</p>

<p><em>¡Que tengan un buen día en el planeta donde se encuentren!</em></p>

<p><strong>Nos vemos en otro bit.</strong></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#python" class="page__taxonomy-item" rel="tag">Python</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#script" class="page__taxonomy-item" rel="tag">Script</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#programacion" class="page__taxonomy-item" rel="tag">Programacion</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Fecha:</strong> <time datetime="2023-03-10T00:00:00-05:00">March 10, 2023</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/forest/" class="pagination--pager" title="HTB forest AD
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
<!--
    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
-->
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Bast1ant1c</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.15.4/js/all.js" integrity="sha384-rOA1PnstxnOBLzCLMcre8ybwbTmemjzdNlILg8O7z1lUkLXozs4DHonlDtnE7fpc" crossorigin="anonymous"></script>
  







  </body>
</html>
